{"version":3,"file":"copy_paste.min.js","sources":["../src/copy_paste.js"],"sourcesContent":["import $ from 'jquery';\nimport ajax from 'core/ajax';\nimport {getString} from 'core/str';\n\nexport const init = () => {\n    let STORAGE_ID = 'lanebs_mod';\n    let SELECTORS = {\n        PASTE_BUTTON: '#id_paste_mod',\n        COPY_BUTTON: '#id_copy_mod',\n        NAME_FIELD: '#id_name',\n        CONTENT_FIELD: '[name=\"content\"]',\n        COVER_FIELD: '[name=\"cover\"]',\n        BIBLIO_RECORD_FIELD: '[name=\"biblio_record\"]',\n        DESCRIPTION_EDITOR_FIELD: '#id_introeditoreditable',\n        DESCRIPTION_TEXTFIELD: '#id_introeditor',\n        CONTENT_NAME_FIELD: '#id_content_name',\n        PAGE_NUMBER_FIELD: '#id_page_number',\n        VISIBLE_SELECT: '#id_visible',\n        IDNUMBER_FIELD: '#id_cmidnumber',\n    };\n    let issetStorage = localStorage.getItem(STORAGE_ID);\n    if (!issetStorage) {\n        $(SELECTORS.PASTE_BUTTON).addClass('hidden');\n    }\n    $(SELECTORS.COPY_BUTTON).on('click', function() {\n        $(SELECTORS.PASTE_BUTTON).removeClass('hidden');\n        let query = window.location.search;\n        let urlParams = new URLSearchParams(query);\n        let modId = urlParams.get('update');\n        if (!modId) {\n            getString('lanebs_copy_attention', 'mod_lanebs').\n            then(function (str) {\n                alert(str);\n            });\n        }\n        localStorage.setItem('lanebs_mod', modId);\n    });\n    $(SELECTORS.PASTE_BUTTON).on('click', function () {\n        let id = parseInt(localStorage.getItem(STORAGE_ID));\n        if (!id) {\n            getString('lanebs_copy_error', 'mod_lanebs').\n            then(function (str) {\n                alert.log(str);\n            });\n        } else {\n            let args = {\n                'id': id\n            };\n            ajax.call([\n                {\n                    methodname: 'mod_lanebs_lanebs_info',\n                    args,\n                }\n            ])[0].then(function(response) {\n                return response;\n            }).done(function(response) {\n                let info = JSON.parse(response.body);\n                $(SELECTORS.BIBLIO_RECORD_FIELD).val(info.biblio_record);\n                $(SELECTORS.COVER_FIELD).val(info.cover);\n                $(SELECTORS.NAME_FIELD).val(info.name);\n                $(SELECTORS.CONTENT_NAME_FIELD).val(info.content_name);\n                $(SELECTORS.DESCRIPTION_EDITOR_FIELD).text(info.intro);\n                $(SELECTORS.DESCRIPTION_TEXTFIELD).val(info.intro);\n                $(SELECTORS.PAGE_NUMBER_FIELD).val(info.page_number);\n                $(SELECTORS.CONTENT_FIELD).val(info.content);\n                $(SELECTORS.VISIBLE_SELECT).val(info.visible);\n                return response;\n            }).fail(function (response) {\n                alert(response);\n                return response;\n            });\n        }\n    });\n};"],"names":["SELECTORS","localStorage","getItem","addClass","on","removeClass","query","window","location","search","modId","URLSearchParams","get","then","str","alert","setItem","id","parseInt","args","call","methodname","response","done","info","JSON","parse","body","val","biblio_record","cover","name","content_name","text","intro","page_number","content","visible","fail","log"],"mappings":"2WAIoB,SAEZA,uBACc,gBADdA,sBAEa,eAFbA,qBAGY,WAHZA,wBAIe,mBAJfA,sBAKa,iBALbA,8BAMqB,yBANrBA,mCAO0B,0BAP1BA,gCAQuB,kBARvBA,6BASoB,mBATpBA,4BAUmB,kBAVnBA,yBAWgB,cAGDC,aAAaC,QAff,mCAiBXF,wBAAwBG,SAAS,8BAErCH,uBAAuBI,GAAG,SAAS,+BAC/BJ,wBAAwBK,YAAY,cAClCC,MAAQC,OAAOC,SAASC,OAExBC,MADY,IAAIC,gBAAgBL,OACdM,IAAI,UACrBF,0BACS,wBAAyB,cACnCG,MAAK,SAAUC,KACXC,MAAMD,QAGdb,aAAae,QAAQ,aAAcN,8BAErCV,wBAAwBI,GAAG,SAAS,eAC9Ba,GAAKC,SAASjB,aAAaC,QAjClB,kBAkCRe,GAKE,KACCE,KAAO,IACDF,kBAELG,KAAK,CACN,CACIC,WAAY,yBACZF,KAAAA,QAEL,GAAGN,MAAK,SAASS,iBACTA,YACRC,MAAK,SAASD,cACTE,KAAOC,KAAKC,MAAMJ,SAASK,gCAC7B3B,+BAA+B4B,IAAIJ,KAAKK,mCACxC7B,uBAAuB4B,IAAIJ,KAAKM,2BAChC9B,sBAAsB4B,IAAIJ,KAAKO,0BAC/B/B,8BAA8B4B,IAAIJ,KAAKQ,kCACvChC,oCAAoCiC,KAAKT,KAAKU,2BAC9ClC,iCAAiC4B,IAAIJ,KAAKU,2BAC1ClC,6BAA6B4B,IAAIJ,KAAKW,iCACtCnC,yBAAyB4B,IAAIJ,KAAKY,6BAClCpC,0BAA0B4B,IAAIJ,KAAKa,SAC9Bf,YACRgB,MAAK,SAAUhB,iBACdP,MAAMO,UACCA,mCA7BD,oBAAqB,cAC/BT,MAAK,SAAUC,KACXC,MAAMwB,IAAIzB"}