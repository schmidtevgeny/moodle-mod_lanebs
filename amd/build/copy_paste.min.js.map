{"version":3,"file":"copy_paste.min.js","sources":["../src/copy_paste.js"],"sourcesContent":["define([\"exports\", \"jquery\", \"core/ajax\", \"core/str\"],\n    function (exports, $, ajax, Str) {\n        return {\n            init: function(title) {\n                let STORAGE_ID = 'lanebs_mod';\n                let SELECTORS = {\n                    PASTE_BUTTON: '#id_paste_mod',\n                    COPY_BUTTON: '#id_copy_mod',\n                    NAME_FIELD: '#id_name',\n                    CONTENT_FIELD: '[name=\"content\"]',\n                    COVER_FIELD: '[name=\"cover\"]',\n                    BIBLIO_RECORD_FIELD: '[name=\"biblio_record\"]',\n                    DESCRIPTION_EDITOR_FIELD: '#id_introeditoreditable',\n                    DESCRIPTION_TEXTFIELD: '#id_introeditor',\n                    CONTENT_NAME_FIELD: '#id_content_name',\n                    PAGE_NUMBER_FIELD: '#id_page_number',\n                    VISIBLE_SELECT: '#id_visible',\n                    IDNUMBER_FIELD: '#id_cmidnumber',\n                };\n                let issetStorage = localStorage.getItem(STORAGE_ID);\n                if (!issetStorage) {\n                    $(SELECTORS.PASTE_BUTTON).addClass('hidden');\n                }\n                $(SELECTORS.COPY_BUTTON).on('click', function(e) {\n                    $(SELECTORS.PASTE_BUTTON).removeClass('hidden');\n                    let query = window.location.search;\n                    let urlParams = new URLSearchParams(query);\n                    let modId = urlParams.get('update');\n                    if (!modId) {\n                        Str.get_string('lanebs_copy_attention', 'mod_lanebs').\n                        done(function (str) {\n                            console.log(str);\n                        });\n                    }\n                    localStorage.setItem('lanebs_mod', modId);\n                });\n                $(SELECTORS.PASTE_BUTTON).on('click', function (e) {\n                    let id = parseInt(localStorage.getItem(STORAGE_ID));\n                    if (!id) {\n                        Str.get_string('lanebs_copy_error', 'mod_lanebs').\n                        done(function (str) {\n                            console.log(str);\n                        });\n                    } else {\n                        let args = {\n                            'id': id\n                        };\n                        ajax.call([\n                            {\n                                methodname: 'mod_lanebs_lanebs_info',\n                                args,\n                            }\n                        ])[0].then(function(response) {\n                            return response;\n                        }).done(function(response) {\n                            let info = JSON.parse(response.body);\n                            $(SELECTORS.BIBLIO_RECORD_FIELD).val(info.biblio_record);\n                            $(SELECTORS.COVER_FIELD).val(info.cover);\n                            $(SELECTORS.NAME_FIELD).val(info.name);\n                            $(SELECTORS.CONTENT_NAME_FIELD).val(info.content_name);\n                            $(SELECTORS.DESCRIPTION_EDITOR_FIELD).text(info.intro);\n                            $(SELECTORS.DESCRIPTION_TEXTFIELD).val(info.intro);\n                            $(SELECTORS.PAGE_NUMBER_FIELD).val(info.page_number);\n                            $(SELECTORS.CONTENT_FIELD).val(info.content);\n                            $(SELECTORS.VISIBLE_SELECT).val(info.visible);\n                            return response;\n                        }).fail(function (response) {\n                            console.log(response);\n                            return false;\n                        });\n                    }\n                });\n            },\n        };\n    });"],"names":["define","exports","$","ajax","Str","init","title","SELECTORS","localStorage","getItem","addClass","on","e","removeClass","query","window","location","search","modId","URLSearchParams","get","get_string","done","str","console","log","setItem","id","parseInt","args","call","methodname","then","response","info","JSON","parse","body","val","biblio_record","cover","name","content_name","text","intro","page_number","content","visible","fail"],"mappings":"AAAAA,+BAAO,CAAC,UAAW,SAAU,YAAa,aACtC,SAAUC,QAASC,EAAGC,KAAMC,KACxB,MAAO,CACHC,KAAM,SAASC,OACX,IACIC,uBACc,gBADdA,sBAEa,eAFbA,qBAGY,WAHZA,wBAIe,mBAJfA,sBAKa,iBALbA,8BAMqB,yBANrBA,mCAO0B,0BAP1BA,gCAQuB,kBARvBA,6BASoB,mBATpBA,4BAUmB,kBAVnBA,yBAWgB,cAGDC,aAAaC,QAff,eAiBbP,EAAEK,wBAAwBG,SAAS,UAEvCR,EAAEK,uBAAuBI,GAAG,SAAS,SAASC,GAC1CV,EAAEK,wBAAwBM,YAAY,UACtC,IAAIC,MAAQC,OAAOC,SAASC,OAExBC,MADY,IAAIC,gBAAgBL,OACdM,IAAI,UACrBF,OACDd,IAAIiB,WAAW,wBAAyB,cACxCC,MAAK,SAAUC,KACXC,QAAQC,IAAIF,QAGpBf,aAAakB,QAAQ,aAAcR,UAEvChB,EAAEK,wBAAwBI,GAAG,SAAS,SAAUC,GAC5C,IAAIe,GAAKC,SAASpB,aAAaC,QAjClB,eAkCb,GAAKkB,GAKE,CACH,IAAIE,KAAO,CACPF,GAAMA,IAEVxB,KAAK2B,KAAK,CACN,CACIC,WAAY,yBACZF,aAEL,GAAGG,MAAK,SAASC,UAChB,OAAOA,YACRX,MAAK,SAASW,UACb,IAAIC,KAAOC,KAAKC,MAAMH,SAASI,MAU/B,OATAnC,EAAEK,+BAA+B+B,IAAIJ,KAAKK,eAC1CrC,EAAEK,uBAAuB+B,IAAIJ,KAAKM,OAClCtC,EAAEK,sBAAsB+B,IAAIJ,KAAKO,MACjCvC,EAAEK,8BAA8B+B,IAAIJ,KAAKQ,cACzCxC,EAAEK,oCAAoCoC,KAAKT,KAAKU,OAChD1C,EAAEK,iCAAiC+B,IAAIJ,KAAKU,OAC5C1C,EAAEK,6BAA6B+B,IAAIJ,KAAKW,aACxC3C,EAAEK,yBAAyB+B,IAAIJ,KAAKY,SACpC5C,EAAEK,0BAA0B+B,IAAIJ,KAAKa,SAC9Bd,YACRe,MAAK,SAAUf,UAEd,OADAT,QAAQC,IAAIQ,WACL,UA7BX7B,IAAIiB,WAAW,oBAAqB,cACpCC,MAAK,SAAUC,KACXC,QAAQC,IAAIF,YAiCpC"}