{"version":3,"sources":["../src/modal_player.js"],"names":["define","exports","$","ajax","ModalFactory","ModalEvents","Notification","Modal","CustomEvents","ModalRegistry","Str","SELECTORS","CONTENT_BLOCK","CLOSE_BUTTON","CLOSE_CROSS","ROOT_MODAL","PLAYER_MODAL","ModalPlayer","root","call","prototype","modal","getFooter","find","length","exception","message","get_string","TYPE","Object","create","constructor","registerEventListeners","getModal","on","events","activate","e","preventDefault","stopPropagation","getRoot","trigger","remove","bind","scrollBottom","agent","navigator","userAgent","toLowerCase","mobile","match","window","innerWidth","linkId","currentTarget","attr","iframeBlock","append","getBody","register"],"mappings":"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","sourcesContent":["define([\n    \"exports\",\n    \"jquery\",\n    \"core/ajax\",\n    \"core/modal_factory\",\n    \"core/modal_events\",\n    \"core/notification\",\n    \"core/modal\",\n    \"core/custom_interaction_events\",\n    \"core/modal_registry\",\n    \"core/str\",\n], function (\n    exports,\n    $,\n    ajax,\n    ModalFactory,\n    ModalEvents,\n    Notification,\n    Modal,\n    CustomEvents,\n    ModalRegistry,\n    Str,\n) {\n    let SELECTORS = {\n        CONTENT_BLOCK: '[data-action=\"player_content_block\"]',\n        CLOSE_BUTTON: '[data-action=\"close_button\"]',\n        CLOSE_CROSS: \".close\",\n        ROOT_MODAL: \"[data-region='modal-container']\",\n        PLAYER_MODAL: 'p[data-action=\"player_modal\"]',\n    };\n\n    /**\n     * Constructor for the Modal\n     *\n     */\n    let ModalPlayer = function(root) {\n        Modal.call(this, root);\n        ModalPlayer.prototype.modal = this;\n\n        if (!this.getFooter().find(SELECTORS.CLOSE_BUTTON).length) {\n            Notification.exception({message: Str.get_string('lanebs_error_close', 'mod_lanebs')});\n        }\n    };\n\n    ModalPlayer.TYPE = 'mod_lanebs-player';\n    ModalPlayer.CONTENT_BLOCK = SELECTORS.CONTENT_BLOCK;\n    ModalPlayer.prototype = Object.create(Modal.prototype);\n    ModalPlayer.prototype.constructor = ModalPlayer;\n\n    ModalPlayer.prototype.registerEventListeners = function () {\n        Modal.prototype.registerEventListeners.call(this);\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.CLOSE_BUTTON, function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.getRoot().trigger('click');\n            this.getRoot().remove()\n            this.getModal().remove();\n        }.bind(this));\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.CLOSE_CROSS, function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.getRoot().trigger('click');\n            this.getRoot().remove()\n            this.getModal().remove();\n        }.bind(this));\n\n        this.getModal().on(CustomEvents.events.scrollBottom, SELECTORS.CONTENT_BLOCK, function (e) {\n            let agent = navigator.userAgent.toLowerCase();\n            let mobile = !!agent.match(/(android|avantgo|blackberry|bolt|boost|cricket|docomo|fone|hiptop|mini|mobi|palm|phone|pie|tablet|up\\.browser|up\\.link|webos|wos|ios)/g);\n            mobile = mobile || (window.innerWidth < 1006); // kostil for ignore redirect window.location.origin + '/m'\n            let linkId = $(e.currentTarget).attr('data-id');\n            let iframeBlock =\n                '<iframe id=\"player_iframe\" src=\"https://www.youtube.com/embed/'+linkId+'\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\"width:100%;height:100%;\">' +\n                '</iframe>';\n            $(SELECTORS.CONTENT_BLOCK).append(iframeBlock);\n            ModalPlayer.prototype.modal.getBody().find(SELECTORS.CONTENT_BLOCK).append(iframeBlock);\n        });\n    };\n\n    ModalRegistry.register(ModalPlayer.TYPE, ModalPlayer, 'mod_lanebs/modal_player');\n\n    return ModalPlayer;\n\n});"],"file":"modal_player.min.js"}