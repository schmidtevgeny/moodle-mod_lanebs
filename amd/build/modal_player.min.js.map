{"version":3,"sources":["../src/modal_player.js"],"names":["define","exports","$","ajax","ModalFactory","ModalEvents","Notification","Modal","CustomEvents","ModalRegistry","Str","SELECTORS","CONTENT_BLOCK","CLOSE_BUTTON","CLOSE_CROSS","ROOT_MODAL","ModalPlayer","root","call","prototype","modal","getFooter","find","length","exception","message","get_string","TYPE","Object","create","constructor","registerEventListeners","getModal","on","events","activate","e","preventDefault","stopPropagation","getRoot","trigger","bind","target","remove","scrollBottom","agent","navigator","userAgent","toLowerCase","mobile","match","window","innerWidth","linkId","currentTarget","attr","console","log","iframeBlock","append","getBody","register"],"mappings":"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","sourcesContent":["define([\n    \"exports\",\n    \"jquery\",\n    \"core/ajax\",\n    \"core/modal_factory\",\n    \"core/modal_events\",\n    \"core/notification\",\n    \"core/modal\",\n    \"core/custom_interaction_events\",\n    \"core/modal_registry\",\n    \"core/str\",\n], function (\n    exports,\n    $,\n    ajax,\n    ModalFactory,\n    ModalEvents,\n    Notification,\n    Modal,\n    CustomEvents,\n    ModalRegistry,\n    Str,\n) {\n    let SELECTORS = {\n        CONTENT_BLOCK: '[data-action=\"player_content_block\"]',\n        CLOSE_BUTTON: '[data-action=\"close_button\"]',\n        CLOSE_CROSS: \".close\",\n        ROOT_MODAL: \"[data-region='modal-container']\",\n    };\n\n    /**\n     * Constructor for the Modal\n     *\n     */\n    let ModalPlayer = function(root) {\n        Modal.call(this, root);\n        ModalPlayer.prototype.modal = this;\n\n        if (!this.getFooter().find(SELECTORS.CLOSE_BUTTON).length) {\n            Notification.exception({message: Str.get_string('lanebs_error_close', 'mod_lanebs')});\n        }\n    };\n\n    ModalPlayer.TYPE = 'mod_lanebs-player';\n    ModalPlayer.CONTENT_BLOCK = SELECTORS.CONTENT_BLOCK;\n    ModalPlayer.prototype = Object.create(Modal.prototype);\n    ModalPlayer.prototype.constructor = ModalPlayer;\n\n    ModalPlayer.prototype.registerEventListeners = function () {\n        Modal.prototype.registerEventListeners.call(this);\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.CLOSE_BUTTON, function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.getRoot().trigger('click');\n        }.bind(this));\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.CLOSE_CROSS, function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.getRoot().trigger('click');\n        }.bind(this));\n\n        this.getRoot().on(CustomEvents.events.activate, function (e) {\n            let root = $(SELECTORS.ROOT_MODAL);\n            if (root.length > 1) { // because this modal second sometimes.\n                root = root[1];    // Kostil, but nothing to do\n            }\n            else {\n                root = root[0];\n            }\n            if (e.target === root) {\n                this.getRoot().remove();\n            }\n            return true;\n        }.bind(this));\n\n        this.getModal().on(CustomEvents.events.scrollBottom, SELECTORS.CONTENT_BLOCK, function (e) {\n            let agent = navigator.userAgent.toLowerCase();\n            let mobile = !!agent.match(/(android|avantgo|blackberry|bolt|boost|cricket|docomo|fone|hiptop|mini|mobi|palm|phone|pie|tablet|up\\.browser|up\\.link|webos|wos|ios)/g);\n            mobile = mobile || (window.innerWidth < 1006); // kostil for ignore redirect window.location.origin + '/m'\n            let linkId = $(e.currentTarget).attr('data-id');\n            console.log(linkId);\n            let iframeBlock =\n                '<iframe id=\"player_iframe\" src=\"https://www.youtube.com/embed/'+linkId+'\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\"width:100%;height:100%;\">' +\n                '</iframe>';\n            console.log(iframeBlock);\n            console.log($(SELECTORS.CONTENT_BLOCK));\n            $(SELECTORS.CONTENT_BLOCK).append(iframeBlock);\n            ModalPlayer.prototype.modal.getBody().find(SELECTORS.CONTENT_BLOCK).append(iframeBlock);\n        });\n    };\n\n    ModalRegistry.register(ModalPlayer.TYPE, ModalPlayer, 'mod_lanebs/modal_player');\n\n    return ModalPlayer;\n\n});"],"file":"modal_player.min.js"}