{"version":3,"sources":["../src/modal_video.js"],"names":["define","exports","$","ajax","ModalFactory","ModalEvents","Notification","Modal","CustomEvents","ModalRegistry","ModalPlayerHandle","Str","SELECTORS","SUBMIT_BUTTON","OPEN_BUTTON","OPEN_BUTTON_CONTAINER","CANCEL_BUTTON","CONTENT_BLOCK","CLOSE_CROSS","ROOT_MODAL","DATA_TOC","BOOK_ID_SELECTOR","SEARCH_CLASS","VIDEOS_FIELD","DELETE_SELECTED","PREVIEW_CLASS","PREVIEW_TEXT","PREVIEW_CONTAINER","TRIGGER_PLAYER","PLAY_BUTTON_HOVER","ModalVideo","root","call","prototype","modal","getFooter","find","length","exception","message","get_string","printTocs","TYPE","Object","create","constructor","registerEventListeners","getModal","on","events","activate","updateVideoField","trigger","bind","tocArgs","id","val","page","getAjaxCall","tocs","console","log","videosArgs","videos","body","getBody","innerTocHtml","issetTocVideo","BreakException","forEach","value","index","videosList","currentPage","video","videoIndex","getYoutubePreview","getYoutubeId","addClass","e","strings","removeClass","html","linkId","target","attr","init","preventDefault","stopPropagation","currentTarget","siblings","issetVideos","getIssetVideos","printVideos","preCheckVideos","methodname","args","callback","then","response","done","JSON","parse","fail","previewBlock","deleteSelectedEvent","link","urlParams","split","URLSearchParams","get","each","videoItem","closest","videoUnique","remove","inputs","url","push","name","text","unique","video_id","stringify","clearAllData","resetModal","register"],"mappings":"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","sourcesContent":["define([\n    \"exports\",\n    \"jquery\",\n    \"core/ajax\",\n    \"core/modal_factory\",\n    \"core/modal_events\",\n    \"core/notification\",\n    \"core/modal\",\n    \"core/custom_interaction_events\",\n    \"core/modal_registry\",\n    \"mod_lanebs/modal_player_handle\",\n    \"core/str\",\n], function (\n    exports,\n    $,\n    ajax,\n    ModalFactory,\n    ModalEvents,\n    Notification,\n    Modal,\n    CustomEvents,\n    ModalRegistry,\n    ModalPlayerHandle,\n    Str,\n) {\n    let SELECTORS = {\n        SUBMIT_BUTTON: \"[data-action='submit_button']\",\n        OPEN_BUTTON: \"#id_modal_video_button\",\n        OPEN_BUTTON_CONTAINER: \"#fitem_id_modal_video_button\",\n        CANCEL_BUTTON: \"[data-action='cancel_button']\",\n        CONTENT_BLOCK: \"[data-action='video_content_block']\",\n        CLOSE_CROSS: \".close\",\n        ROOT_MODAL: \"[data-region='modal-container']\",\n        DATA_TOC: \"#data-toc\",\n        BOOK_ID_SELECTOR: \"[name='content']\",\n        SEARCH_CLASS: \".modal_video\",\n        VIDEOS_FIELD: \"input[name='videos']\",\n        DELETE_SELECTED: \"span.closes\",\n        PREVIEW_CLASS: \".video-item\",\n        PREVIEW_TEXT: \"span.video_preview\",\n        PREVIEW_CONTAINER: \".video_preview_container\",\n        TRIGGER_PLAYER: \"img.modal_video\",\n        PLAY_BUTTON_HOVER: \".video_play_hover\",\n    };\n\n    /**\n     * Constructor for the Modal\n     *\n     */\n    let ModalVideo = function(root) {\n        Modal.call(this, root);\n        ModalVideo.prototype.modal = this;\n        if (!this.getFooter().find(SELECTORS.CANCEL_BUTTON).length) {\n            Notification.exception({message: Str.get_string('lanebs_error_close', 'mod_lanebs')});\n        }\n        this.printTocs();\n    };\n\n    ModalVideo.TYPE = 'mod_lanebs-video';\n    ModalVideo.CONTENT_BLOCK = SELECTORS.CONTENT_BLOCK;\n    ModalVideo.prototype = Object.create(Modal.prototype);\n    ModalVideo.prototype.constructor = ModalVideo;\n\n    ModalVideo.prototype.registerEventListeners = function () {\n        Modal.prototype.registerEventListeners.call(this);\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.SUBMIT_BUTTON, ModalVideo.prototype.updateVideoField);\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.CANCEL_BUTTON, function () {\n            $(this).trigger('hide');\n        }.bind(this));\n\n    };\n\n    ModalVideo.prototype.printTocs = function () {\n        let tocArgs = {\n            id: $(SELECTORS.BOOK_ID_SELECTOR).val(),\n            page: 0\n        };\n        ModalVideo.prototype.getAjaxCall('mod_lanebs_toc_name', tocArgs, function (tocs) {\n            console.log(tocs);\n            let videosArgs = {\n                id: $(SELECTORS.BOOK_ID_SELECTOR).val()\n            };\n            ModalVideo.prototype.getAjaxCall('mod_lanebs_toc_videos', videosArgs, function(videos) {\n                let body = ModalVideo.prototype.modal.getBody();\n                let innerTocHtml = '';\n                let issetTocVideo = [];\n                let BreakException = {};\n                tocs.forEach(function (value, index) {\n                    let videosList = '<ul class=\"modal_video\">';\n                    let currentPage = value['page'];\n                    issetTocVideo[index] = false;\n                    try {\n                        videos.forEach(function (video, videoIndex) {\n                            if (video['start_page'] === currentPage) {\n                                issetTocVideo[index] = true;\n                                videosList +=\n                                    '<li class=\"modal_video\">' +\n                                    '<label for=\"video_' + videoIndex + '\" class=\"modal_video\">' +\n                                    '<p class=\"modal_video\">' +\n                                    '<input type=\"checkbox\" data-unique=\"' + video['unique_id'] + '_' + index + '\" class=\"modal_video\" id=\"video_' + videoIndex + '\" data-url=\"' + video['link_url'] + '\" />' +\n                                    video['link_name'] +\n                                    '</p>' +\n                                    '<img src=\"' + ModalVideo.prototype.getYoutubePreview(video['link_url']) + '\" alt=\"' + video['link_name'] + '\" class=\"modal_video\" data-id=\"' + ModalVideo.prototype.getYoutubeId(video['link_url']) + '\" />' +\n                                    '<div class=\"video_play_hover\"></div>' +\n                                    '</label>' +\n                                    '</li>';\n                            } else if (video['start_page'] === '-1') {\n                                issetTocVideo[index] = undefined;\n                                $(SELECTORS.OPEN_BUTTON_CONTAINER).addClass('hidden');\n                                throw BreakException;\n                            }\n                        });\n                    } catch (e) {\n                        if (e !== BreakException) throw e;\n                    }\n                    videosList += '</ul>';\n                    if (issetTocVideo[index] === true) {\n                        innerTocHtml +=\n                            '<div class=\"item-toc\" style=\"margin-bottom:10px;\" data-page=\"' + currentPage + '\">' +\n                            '<span>' + value['title'] + ', '+ModalVideo.prototype.strings['lanebs_read_pg']+'. '+value['page']+'</span><br>' +\n                            '<a class=\"\" data-toggle=\"collapse\" href=\"#collapseDescription_' + currentPage + '_' + index + '\" role=\"button\">' +\n                            'Видео-рекомендации' +\n                            '</a>' +\n                            '<div class=\"collapse\" id=\"collapseDescription_' + currentPage + '_' + index + '\">' + videosList + '</div>' +\n                            '</div>';\n                    }\n                });\n                if (issetTocVideo[0] !== undefined) {\n                    $(SELECTORS.OPEN_BUTTON_CONTAINER).removeClass('hidden');\n                    body.find(SELECTORS.DATA_TOC).html(innerTocHtml);\n                    $(body.find(SELECTORS.TRIGGER_PLAYER)).on('click', function (e) {\n                        let linkId = $(e.target).attr('data-id');\n                        ModalPlayerHandle.init(e, linkId);\n                    });\n                    $(body.find(SELECTORS.PLAY_BUTTON_HOVER)).on('click', function (e) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        $(e.currentTarget).siblings(SELECTORS.TRIGGER_PLAYER).trigger('click');\n                    });\n                }\n                let issetVideos = ModalVideo.prototype.getIssetVideos();\n                if (issetVideos) {\n                    ModalVideo.prototype.printVideos(issetVideos);\n                    ModalVideo.prototype.preCheckVideos(issetVideos);\n                }\n            });\n        });\n    };\n\n    ModalVideo.prototype.getAjaxCall = function (methodname, args, callback) {\n        return ajax.call([\n            {\n                methodname: methodname,\n                args,\n            }\n        ])[0].then(function(response) {\n            return response;\n        }).done(function(response) {\n            callback(JSON.parse(response['body']));\n            return true;\n        }).fail(function (response) {\n            console.log(response);\n            return false;\n        });\n    };\n\n    ModalVideo.prototype.printVideos = function (videos) {\n        let previewBlock = '<div class=\"col-md-3\"></div><div class=\"container col-md-9\">';\n        videos.forEach(function (value, index) {\n            previewBlock +=\n                '<div class=\"item video-item row\">' +\n                '<div class=\"img-wraps\">' +\n                '<span class=\"closes\" title=\"Delete\" data-unique=\"'+value['unique']+'\">×</span>' +\n                '<img width=\"100px;\" height=\"100px;\" src=\"'+ModalVideo.prototype.getYoutubePreview(value['link'])+'\" alt=\"'+value['name']+'\"  class=\"img-responsive\" src=\"images/image.jpg\" data-id=\"'+ModalVideo.prototype.getYoutubeId(value['link'])+'\"/>' +\n                '</div>' +\n                '<span class=\"video_preview\">'+value['name']+'</span>' +\n                '</div>';\n        });\n        previewBlock += '</div>';\n        $(SELECTORS.PREVIEW_CONTAINER).html(previewBlock);\n        ModalVideo.prototype.deleteSelectedEvent();\n    };\n\n    ModalVideo.prototype.getYoutubeId = function (link) {\n        let urlParams = link.split('?')[1];\n        return (new URLSearchParams(urlParams)).get('v');\n    };\n\n    ModalVideo.prototype.getYoutubePreview = function (link) {\n        let id = ModalVideo.prototype.getYoutubeId(link);\n        return 'https://img.youtube.com/vi/'+id+'/0.jpg';\n    };\n\n    ModalVideo.prototype.getIssetVideos = function () {\n        let videos = $(SELECTORS.VIDEOS_FIELD).val();\n        try {\n            return JSON.parse(videos);\n        } catch (e) {\n            console.log(e.message);\n            return '';\n        }\n    };\n\n    ModalVideo.prototype.preCheckVideos = function (videos) {\n        console.log(ModalVideo.prototype.modal);\n        console.log(ModalVideo.prototype.modal.getBody());\n        videos.forEach(function (value, index) {\n            console.log(ModalVideo.prototype.modal.getBody().find('input[data-unique=\"'+value['unique']+'\"]'));\n            ModalVideo.prototype.modal.getBody().find('input[data-unique=\"'+value['unique']+'\"]').trigger('click');\n        });\n    };\n\n    ModalVideo.prototype.deleteSelectedEvent = function () {\n        $(SELECTORS.DELETE_SELECTED).each(function (index, value) {\n            $(value).on('click', function (e) {\n                let videoItem = $(e.target).closest(SELECTORS.PREVIEW_CLASS);\n                console.log(videoItem);\n                let videoUnique = $(e.target).attr('data-unique');\n                console.log(videoUnique);\n                ModalVideo.prototype.modal.getBody().find('input[data-unique=\"'+videoUnique+'\"]').trigger('click');\n                $(videoItem).remove();\n                ModalVideo.prototype.updateVideoField();\n            });\n        });\n    };\n\n    ModalVideo.prototype.updateVideoField = function () {\n        let videos = [];\n        let inputs = ModalVideo.prototype.modal.getBody().find('ul'+SELECTORS.SEARCH_CLASS+' input:checked');\n        inputs.each(function (index, value) {\n            let url = $(value).attr('data-url');\n            videos.push(\n                {\n                    link: url,\n                    name: $(value).closest('p').text(),\n                    unique: $(value).attr('data-unique'),\n                    video_id: ModalVideo.prototype.getYoutubeId(url)\n                });\n        });\n        $(SELECTORS.VIDEOS_FIELD).val(JSON.stringify(videos));\n        ModalVideo.prototype.printVideos(videos);\n        $(SELECTORS.CANCEL_BUTTON).trigger('click');\n        console.log(videos);\n    }\n\n    ModalVideo.prototype.clearAllData = function () {\n        $(SELECTORS.VIDEOS_FIELD).val('[]');\n        $(SELECTORS.PREVIEW_CONTAINER).html('');\n    };\n\n    ModalVideo.prototype.resetModal = function () {\n        ModalVideo.prototype.clearAllData();\n        ModalVideo.prototype.printTocs();\n    }\n\n\n    ModalRegistry.register(ModalVideo.TYPE, ModalVideo, 'mod_lanebs/modal_video');\n\n    return ModalVideo;\n});"],"file":"modal_video.min.js"}