{"version":3,"sources":["../src/modal_video.js"],"names":["define","exports","$","ajax","ModalFactory","ModalEvents","Notification","Modal","CustomEvents","ModalRegistry","ModalPlayerHandle","SELECTORS","SUBMIT_BUTTON","OPEN_BUTTON","OPEN_BUTTON_CONTAINER","CANCEL_BUTTON","CONTENT_BLOCK","CLOSE_CROSS","ROOT_MODAL","DATA_TOC","BOOK_ID_SELECTOR","SEARCH_CLASS","VIDEOS_FIELD","DELETE_SELECTED","PREVIEW_CLASS","PREVIEW_TEXT","PREVIEW_CONTAINER","TRIGGER_PLAYER","PLAY_BUTTON_HOVER","ModalVideo","root","call","prototype","modal","printTocs","TYPE","Object","create","constructor","registerEventListeners","getModal","on","events","activate","updateVideoField","getRoot","destroy","getBackdrop","then","backdrop","hide","bind","bookId","val","getAjaxCall","id","page","tocs","videosArgs","videos","body","getBody","innerTocHtml","issetTocVideo","BreakException","forEach","value","index","videosList","currentPage","uniqueIndex","video","getYoutubePreview","getYoutubeId","closest","addClass","e","strings","removeClass","find","html","linkId","target","attr","init","preventDefault","stopPropagation","currentTarget","siblings","trigger","issetVideos","getIssetVideos","printVideos","preCheckVideos","methodname","args","callback","response","done","JSON","parse","fail","console","log","previewBlock","deleteSelectedEvent","link","urlParams","split","URLSearchParams","get","message","each","videoItem","videoUnique","remove","inputs","url","push","name","text","unique","video_id","stringify","clearAllData","resetModal","register"],"mappings":"AAAAA,OAAM,0BAAC,CACH,SADG,CAEH,QAFG,CAGH,WAHG,CAIH,oBAJG,CAKH,mBALG,CAMH,mBANG,CAOH,YAPG,CAQH,gCARG,CASH,qBATG,CAUH,gCAVG,CAWH,UAXG,CAAD,CAYH,SACCC,CADD,CAECC,CAFD,CAGCC,CAHD,CAICC,CAJD,CAKCC,CALD,CAMCC,CAND,CAOCC,CAPD,CAQCC,CARD,CASCC,CATD,CAUCC,CAVD,CAYD,IACMC,CAAAA,CAAS,CAAG,CACZC,aAAa,CAAE,+BADH,CAEZC,WAAW,CAAE,wBAFD,CAGZC,qBAAqB,CAAE,wBAHX,CAIZC,aAAa,CAAE,8BAJH,CAKZC,aAAa,CAAE,qCALH,CAMZC,WAAW,CAAE,QAND,CAOZC,UAAU,CAAE,iCAPA,CAQZC,QAAQ,CAAE,WARE,CASZC,gBAAgB,CAAE,kBATN,CAUZC,YAAY,CAAE,cAVF,CAWZC,YAAY,CAAE,sBAXF,CAYZC,eAAe,CAAE,aAZL,CAaZC,aAAa,CAAE,aAbH,CAcZC,YAAY,CAAE,oBAdF,CAeZC,iBAAiB,CAAE,0BAfP,CAgBZC,cAAc,CAAE,iBAhBJ,CAiBZC,iBAAiB,CAAE,mBAjBP,CADlB,CAyBMC,CAAU,CAAG,SAASC,CAAT,CAAe,CAC5BvB,CAAK,CAACwB,IAAN,CAAW,IAAX,CAAiBD,CAAjB,EACAD,CAAU,CAACG,SAAX,CAAqBC,KAArB,CAA6B,IAA7B,CACA,KAAKC,SAAL,EACH,CA7BH,CA+BEL,CAAU,CAACM,IAAX,CAAkB,kBAAlB,CACAN,CAAU,CAACb,aAAX,CAA2BL,CAAS,CAACK,aAArC,CACAa,CAAU,CAACG,SAAX,CAAuBI,MAAM,CAACC,MAAP,CAAc9B,CAAK,CAACyB,SAApB,CAAvB,CACAH,CAAU,CAACG,SAAX,CAAqBM,WAArB,CAAmCT,CAAnC,CAEAA,CAAU,CAACG,SAAX,CAAqBO,sBAArB,CAA8C,UAAY,CACtDhC,CAAK,CAACyB,SAAN,CAAgBO,sBAAhB,CAAuCR,IAAvC,CAA4C,IAA5C,EAEA,KAAKS,QAAL,GAAgBC,EAAhB,CAAmBjC,CAAY,CAACkC,MAAb,CAAoBC,QAAvC,CAAiDhC,CAAS,CAACC,aAA3D,CAA0EiB,CAAU,CAACG,SAAX,CAAqBY,gBAA/F,EAEA,KAAKC,OAAL,GAAeJ,EAAf,CAAkBjC,CAAY,CAACkC,MAAb,CAAoBC,QAAtC,CAAgDhC,CAAS,CAACI,aAAV,CAAwB,IAAxB,CAA6BJ,CAAS,CAACM,WAAvF,CAAoG,UAAY,CAC5G,KAAK6B,OAAL,GACA,KAAKC,WAAL,GAAmBC,IAAnB,CAAwB,SAAUC,CAAV,CAAoB,CACxCA,CAAQ,CAACC,IAAT,EACH,CAFD,CAGH,CALmG,CAKlGC,IALkG,CAK7F,IAL6F,CAApG,CASH,CAdD,CAgBAtB,CAAU,CAACG,SAAX,CAAqBE,SAArB,CAAiC,UAAY,CACzC,GAAIkB,CAAAA,CAAM,CAAGlD,CAAC,CAACS,CAAS,CAACS,gBAAX,CAAD,CAA8BiC,GAA9B,EAAb,CACA,GAAe,EAAX,GAAAD,CAAJ,CAAmB,CAKfvB,CAAU,CAACG,SAAX,CAAqBsB,WAArB,CAAiC,qBAAjC,CAJc,CACVC,EAAE,CAAEH,CADM,CAEVI,IAAI,CAAE,CAFI,CAId,CAAiE,SAAUC,CAAV,CAAgB,CAC7E,GAAIC,CAAAA,CAAU,CAAG,CACbH,EAAE,CAAErD,CAAC,CAACS,CAAS,CAACS,gBAAX,CAAD,CAA8BiC,GAA9B,EADS,CAAjB,CAGAxB,CAAU,CAACG,SAAX,CAAqBsB,WAArB,CAAiC,uBAAjC,CAA0DI,CAA1D,CAAsE,SAAUC,CAAV,CAAkB,IAChFC,CAAAA,CAAI,CAAG/B,CAAU,CAACG,SAAX,CAAqBC,KAArB,CAA2B4B,OAA3B,EADyE,CAEhFC,CAAY,CAAG,EAFiE,CAGhFC,CAAa,CAAG,EAHgE,CAIhFC,CAAc,CAAG,EAJ+D,CAKpF,GAAIP,CAAJ,CAAU,CACNA,CAAI,CAACQ,OAAL,CAAa,SAAUC,CAAV,CAAiBC,CAAjB,CAAwB,IAC7BC,CAAAA,CAAU,CAAG,4BADgB,CAE7BC,CAAW,CAAGH,CAAK,KAFU,CAGjCH,CAAa,CAACI,CAAD,CAAb,IACA,GAAIG,CAAAA,CAAJ,CACA,GAAI,CACAX,CAAM,CAACM,OAAP,CAAe,SAAUM,CAAV,CAA6B,CACxC,GAAIA,CAAK,WAAL,GAAwBF,CAA5B,CAAyC,CACrCN,CAAa,CAACI,CAAD,CAAb,IACAG,CAAW,CAAGC,CAAK,UAAL,CAAqB,GAArB,CAA2BJ,CAAzC,CACAC,CAAU,EACN,gDACuBE,CADvB,6FAGyCA,CAHzC,CAGuD,sCAHvD,CAG4FA,CAH5F,CAG0G,gBAH1G,CAG2HC,CAAK,SAHhI,CAG+I,OAH/I,CAIAA,CAAK,UAJL,mBAMe1C,CAAU,CAACG,SAAX,CAAqBwC,iBAArB,CAAuCD,CAAK,SAA5C,CANf,CAM2E,WAN3E,CAMuFA,CAAK,UAN5F,CAM4G,qCAN5G,CAMgJ1C,CAAU,CAACG,SAAX,CAAqByC,YAArB,CAAkCF,CAAK,SAAvC,CANhJ,2DAUP,CAdD,IAcO,IAA4B,IAAxB,GAAAA,CAAK,WAAT,CAAkC,CACrCR,CAAa,CAACI,CAAD,CAAb,QACAjE,CAAC,CAACS,CAAS,CAACG,qBAAX,CAAD,CAAmC4D,OAAnC,CAA2C,aAA3C,EAA0DC,QAA1D,CAAmE,QAAnE,EACA,KAAMX,CAAAA,CACT,CACJ,CApBD,CAqBH,CAAC,MAAOY,CAAP,CAAU,CACR,GAAIA,CAAC,GAAKZ,CAAV,CAA0B,KAAMY,CAAAA,CACnC,CACDR,CAAU,EAAI,OAAd,CACA,GAAI,KAAAL,CAAa,CAACI,CAAD,CAAjB,CAAmC,CAC/BL,CAAY,EACR,qEAAkEO,CAAlE,aACWH,CAAK,MADhB,CAC4B,IAD5B,CACmCrC,CAAU,CAACG,SAAX,CAAqB6C,OAArB,eADnC,CACoF,IADpF,CAC2FX,CAAK,KADhG,kFAEmEG,CAFnE,CAEiF,GAFjF,CAEuFF,CAFvF,mLAKmDE,CALnD,CAKiE,GALjE,CAKuEF,CALvE,CAK+E,KAL/E,CAKsFC,CALtF,eAOP,CACJ,CAzCD,CA0CH,CACD,GAAIL,CAAa,CAAC,CAAD,CAAb,SAAJ,CAAoC,CAChC7D,CAAC,CAACS,CAAS,CAACG,qBAAX,CAAD,CAAmC4D,OAAnC,CAA2C,aAA3C,EAA0DI,WAA1D,CAAsE,QAAtE,EACAlB,CAAI,CAACmB,IAAL,CAAUpE,CAAS,CAACQ,QAApB,EAA8B6D,IAA9B,CAAmClB,CAAnC,EACA5D,CAAC,CAAC0D,CAAI,CAACmB,IAAL,CAAUpE,CAAS,CAACgB,cAApB,CAAD,CAAD,CAAuCc,EAAvC,CAA0C,OAA1C,CAAmD,SAAUmC,CAAV,CAAa,CAC5D,GAAIK,CAAAA,CAAM,CAAG/E,CAAC,CAAC0E,CAAC,CAACM,MAAH,CAAD,CAAYC,IAAZ,CAAiB,SAAjB,CAAb,CACAzE,CAAiB,CAAC0E,IAAlB,CAAuBR,CAAvB,CAA0BK,CAA1B,CACH,CAHD,EAIA/E,CAAC,CAAC0D,CAAI,CAACmB,IAAL,CAAUpE,CAAS,CAACiB,iBAApB,CAAD,CAAD,CAA0Ca,EAA1C,CAA6C,OAA7C,CAAsD,SAAUmC,CAAV,CAAa,CAC/DA,CAAC,CAACS,cAAF,GACAT,CAAC,CAACU,eAAF,GACApF,CAAC,CAAC0E,CAAC,CAACW,aAAH,CAAD,CAAmBC,QAAnB,CAA4B7E,CAAS,CAACgB,cAAtC,EAAsD8D,OAAtD,CAA8D,OAA9D,CACH,CAJD,CAKH,CACD,GAAIC,CAAAA,CAAW,CAAG7D,CAAU,CAACG,SAAX,CAAqB2D,cAArB,EAAlB,CACA,GAAID,CAAJ,CAAiB,CACb7D,CAAU,CAACG,SAAX,CAAqB4D,WAArB,CAAiCF,CAAjC,EACA7D,CAAU,CAACG,SAAX,CAAqB6D,cAArB,CAAoCH,CAApC,CACH,CACJ,CAnED,CAoEH,CAxED,CAyEH,CACJ,CAjFD,CAmFA7D,CAAU,CAACG,SAAX,CAAqBsB,WAArB,CAAmC,SAAUwC,CAAV,CAAsBC,CAAtB,CAA4BC,CAA5B,CAAsC,CACrE,MAAO7F,CAAAA,CAAI,CAAC4B,IAAL,CAAU,CACb,CACI+D,UAAU,CAAEA,CADhB,CAEIC,IAAI,CAAJA,CAFJ,CADa,CAAV,EAKJ,CALI,EAKD/C,IALC,CAKI,SAASiD,CAAT,CAAmB,CAC1B,MAAOA,CAAAA,CACV,CAPM,EAOJC,IAPI,CAOC,SAASD,CAAT,CAAmB,CACvBD,CAAQ,CAACG,IAAI,CAACC,KAAL,CAAWH,CAAQ,KAAnB,CAAD,CAAR,CACA,QACH,CAVM,EAUJI,IAVI,CAUC,SAAUJ,CAAV,CAAoB,CACxBK,OAAO,CAACC,GAAR,CAAYN,CAAZ,EACA,QACH,CAbM,CAcV,CAfD,CAiBApE,CAAU,CAACG,SAAX,CAAqB4D,WAArB,CAAmC,SAAUjC,CAAV,CAAkB,CACjD,GAAI6C,CAAAA,CAAY,CAAG,kEAAnB,CACA7C,CAAM,CAACM,OAAP,CAAe,SAAUC,CAAV,CAAwB,CACnCsC,CAAY,EACR,qHAEoDtC,CAAK,OAFzD,gEAG4CrC,CAAU,CAACG,SAAX,CAAqBwC,iBAArB,CAAuCN,CAAK,KAA5C,CAH5C,CAGkG,WAHlG,CAG4GA,CAAK,KAHjH,CAG0H,kEAH1H,CAGuLrC,CAAU,CAACG,SAAX,CAAqByC,YAArB,CAAkCP,CAAK,KAAvC,CAHvL,4CAK+BA,CAAK,KALpC,gBAOP,CATD,EAUAsC,CAAY,EAAI,QAAhB,CACAtG,CAAC,CAACS,CAAS,CAACe,iBAAX,CAAD,CAA+BsD,IAA/B,CAAoCwB,CAApC,EACA3E,CAAU,CAACG,SAAX,CAAqByE,mBAArB,EACH,CAfD,CAiBA5E,CAAU,CAACG,SAAX,CAAqByC,YAArB,CAAoC,SAAUiC,CAAV,CAAgB,CAChD,GAAIC,CAAAA,CAAS,CAAGD,CAAI,CAACE,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAAhB,CACA,MAAQ,IAAIC,CAAAA,eAAJ,CAAoBF,CAApB,CAAD,CAAiCG,GAAjC,CAAqC,GAArC,CACV,CAHD,CAKAjF,CAAU,CAACG,SAAX,CAAqBwC,iBAArB,CAAyC,SAAUkC,CAAV,CAAgB,CACrD,GAAInD,CAAAA,CAAE,CAAG1B,CAAU,CAACG,SAAX,CAAqByC,YAArB,CAAkCiC,CAAlC,CAAT,CACA,MAAO,8BAA8BnD,CAA9B,CAAiC,QAC3C,CAHD,CAKA1B,CAAU,CAACG,SAAX,CAAqB2D,cAArB,CAAsC,UAAY,CAC9C,GAAIhC,CAAAA,CAAM,CAAGzD,CAAC,CAACS,CAAS,CAACW,YAAX,CAAD,CAA0B+B,GAA1B,EAAb,CACA,GAAI,CACA,MAAO8C,CAAAA,IAAI,CAACC,KAAL,CAAWzC,CAAX,CACV,CAAC,MAAOiB,CAAP,CAAU,CACR0B,OAAO,CAACC,GAAR,CAAY3B,CAAC,CAACmC,OAAd,EACA,MAAO,EACV,CACJ,CARD,CAUAlF,CAAU,CAACG,SAAX,CAAqB6D,cAArB,CAAsC,SAAUlC,CAAV,CAAkB,CACpDA,CAAM,CAACM,OAAP,CAAe,SAAUC,CAAV,CAAwB,CACnCrC,CAAU,CAACG,SAAX,CAAqBC,KAArB,CAA2B4B,OAA3B,GAAqCkB,IAArC,CAA0C,uBAAsBb,CAAK,OAA3B,CAAsC,KAAhF,EAAsFuB,OAAtF,CAA8F,OAA9F,CACH,CAFD,CAGH,CAJD,CAMA5D,CAAU,CAACG,SAAX,CAAqByE,mBAArB,CAA2C,UAAY,CACnDvG,CAAC,CAACS,CAAS,CAACY,eAAX,CAAD,CAA6ByF,IAA7B,CAAkC,SAAU7C,CAAV,CAAiBD,CAAjB,CAAwB,CACtDhE,CAAC,CAACgE,CAAD,CAAD,CAASzB,EAAT,CAAY,OAAZ,CAAqB,SAAUmC,CAAV,CAAa,IAC1BqC,CAAAA,CAAS,CAAG/G,CAAC,CAAC0E,CAAC,CAACM,MAAH,CAAD,CAAYR,OAAZ,CAAoB/D,CAAS,CAACa,aAA9B,CADc,CAE1B0F,CAAW,CAAGhH,CAAC,CAAC0E,CAAC,CAACM,MAAH,CAAD,CAAYC,IAAZ,CAAiB,aAAjB,CAFY,CAG9BtD,CAAU,CAACG,SAAX,CAAqBC,KAArB,CAA2B4B,OAA3B,GAAqCkB,IAArC,CAA0C,uBAAsBmC,CAAtB,CAAkC,KAA5E,EAAkFzB,OAAlF,CAA0F,OAA1F,EACAvF,CAAC,CAAC+G,CAAD,CAAD,CAAaE,MAAb,GACAtF,CAAU,CAACG,SAAX,CAAqBY,gBAArB,EACH,CAND,CAOH,CARD,CASH,CAVD,CAYAf,CAAU,CAACG,SAAX,CAAqBY,gBAArB,CAAwC,UAAY,IAC5Ce,CAAAA,CAAM,CAAG,EADmC,CAE5CyD,CAAM,CAAGvF,CAAU,CAACG,SAAX,CAAqBC,KAArB,CAA2B4B,OAA3B,GAAqCkB,IAArC,CAA0C,KAAKpE,CAAS,CAACU,YAAf,CAA4B,gBAAtE,CAFmC,CAGhD+F,CAAM,CAACJ,IAAP,CAAY,SAAU7C,CAAV,CAAiBD,CAAjB,CAAwB,CAChC,GAAImD,CAAAA,CAAG,CAAGnH,CAAC,CAACgE,CAAD,CAAD,CAASiB,IAAT,CAAc,UAAd,CAAV,CACAxB,CAAM,CAAC2D,IAAP,CACI,CACIZ,IAAI,CAAEW,CADV,CAEIE,IAAI,CAAErH,CAAC,CAACgE,CAAD,CAAD,CAASQ,OAAT,CAAiB,GAAjB,EAAsB8C,IAAtB,EAFV,CAGIC,MAAM,CAAEvH,CAAC,CAACgE,CAAD,CAAD,CAASiB,IAAT,CAAc,aAAd,CAHZ,CAIIuC,QAAQ,CAAE7F,CAAU,CAACG,SAAX,CAAqByC,YAArB,CAAkC4C,CAAlC,CAJd,CADJ,CAOH,CATD,EAUAnH,CAAC,CAACS,CAAS,CAACW,YAAX,CAAD,CAA0B+B,GAA1B,CAA8B8C,IAAI,CAACwB,SAAL,CAAehE,CAAf,CAA9B,EACA9B,CAAU,CAACG,SAAX,CAAqB4D,WAArB,CAAiCjC,CAAjC,EACAzD,CAAC,CAACS,CAAS,CAACI,aAAX,CAAD,CAA2B0E,OAA3B,CAAmC,OAAnC,CACH,CAhBD,CAkBA5D,CAAU,CAACG,SAAX,CAAqB4F,YAArB,CAAoC,UAAY,CAC5C1H,CAAC,CAACS,CAAS,CAACW,YAAX,CAAD,CAA0B+B,GAA1B,CAA8B,IAA9B,EACAnD,CAAC,CAACS,CAAS,CAACe,iBAAX,CAAD,CAA+BsD,IAA/B,CAAoC,EAApC,CACH,CAHD,CAKAnD,CAAU,CAACG,SAAX,CAAqB6F,UAArB,CAAkC,UAAY,CAC1ChG,CAAU,CAACG,SAAX,CAAqB4F,YAArB,GACA/F,CAAU,CAACG,SAAX,CAAqBE,SAArB,EACH,CAHD,CAMAzB,CAAa,CAACqH,QAAd,CAAuBjG,CAAU,CAACM,IAAlC,CAAwCN,CAAxC,CAAoD,wBAApD,EAEA,MAAOA,CAAAA,CACV,CAvQK,CAAN","sourcesContent":["define([\n    \"exports\",\n    \"jquery\",\n    \"core/ajax\",\n    \"core/modal_factory\",\n    \"core/modal_events\",\n    \"core/notification\",\n    \"core/modal\",\n    \"core/custom_interaction_events\",\n    \"core/modal_registry\",\n    \"mod_lanebs/modal_player_handle\",\n    \"core/str\",\n], function (\n    exports,\n    $,\n    ajax,\n    ModalFactory,\n    ModalEvents,\n    Notification,\n    Modal,\n    CustomEvents,\n    ModalRegistry,\n    ModalPlayerHandle,\n    Str,\n) {\n    let SELECTORS = {\n        SUBMIT_BUTTON: \"[data-action='submit_button']\",\n        OPEN_BUTTON: \"#id_modal_video_button\",\n        OPEN_BUTTON_CONTAINER: \"#id_modal_video_button\",\n        CANCEL_BUTTON: \"[data-action='close_button']\",\n        CONTENT_BLOCK: \"[data-action='video_content_block']\",\n        CLOSE_CROSS: \".close\",\n        ROOT_MODAL: \"[data-region='modal-container']\",\n        DATA_TOC: \"#data-toc\",\n        BOOK_ID_SELECTOR: \"[name='content']\",\n        SEARCH_CLASS: \".modal_video\",\n        VIDEOS_FIELD: \"input[name='videos']\",\n        DELETE_SELECTED: \"span.closes\",\n        PREVIEW_CLASS: \".video-item\",\n        PREVIEW_TEXT: \"span.video_preview\",\n        PREVIEW_CONTAINER: \".video_preview_container\",\n        TRIGGER_PLAYER: \"img.modal_video\",\n        PLAY_BUTTON_HOVER: \".video_play_hover\",\n    };\n\n    /**\n     * Constructor for the Modal\n     *\n     */\n    let ModalVideo = function(root) {\n        Modal.call(this, root);\n        ModalVideo.prototype.modal = this;\n        this.printTocs();\n    };\n\n    ModalVideo.TYPE = 'mod_lanebs-video';\n    ModalVideo.CONTENT_BLOCK = SELECTORS.CONTENT_BLOCK;\n    ModalVideo.prototype = Object.create(Modal.prototype);\n    ModalVideo.prototype.constructor = ModalVideo;\n\n    ModalVideo.prototype.registerEventListeners = function () {\n        Modal.prototype.registerEventListeners.call(this);\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.SUBMIT_BUTTON, ModalVideo.prototype.updateVideoField);\n\n        this.getRoot().on(CustomEvents.events.activate, SELECTORS.CANCEL_BUTTON+', '+SELECTORS.CLOSE_CROSS, function () {\n            this.destroy();\n            this.getBackdrop().then(function (backdrop) {\n                backdrop.hide();\n            });\n        }.bind(this));\n/*        this.getModal().on(CustomEvents.events.activate, SELECTORS.CANCEL_BUTTON, function () {\n            $(this).trigger('hide');\n        }.bind(this));*/\n    };\n\n    ModalVideo.prototype.printTocs = function () {\n        let bookId = $(SELECTORS.BOOK_ID_SELECTOR).val();\n        if (bookId !== '') {\n            let tocArgs = {\n                id: bookId,\n                page: 0\n            };\n            ModalVideo.prototype.getAjaxCall('mod_lanebs_toc_name', tocArgs, function (tocs) {\n                let videosArgs = {\n                    id: $(SELECTORS.BOOK_ID_SELECTOR).val()\n                };\n                ModalVideo.prototype.getAjaxCall('mod_lanebs_toc_videos', videosArgs, function (videos) {\n                    let body = ModalVideo.prototype.modal.getBody();\n                    let innerTocHtml = '';\n                    let issetTocVideo = [];\n                    let BreakException = {};\n                    if (tocs) {\n                        tocs.forEach(function (value, index) {\n                            let videosList = '<ul class=\"modal_video\">';\n                            let currentPage = value['page'];\n                            issetTocVideo[index] = false;\n                            let uniqueIndex;\n                            try {\n                                videos.forEach(function (video, videoIndex) {\n                                    if (video['start_page'] === currentPage) {\n                                        issetTocVideo[index] = true;\n                                        uniqueIndex = video['unique_id'] + '_' + index;\n                                        videosList +=\n                                            '<li class=\"modal_video\">' +\n                                            '<label for=\"video_' + uniqueIndex + '\" class=\"modal_video\">' +\n                                            '<p class=\"modal_video\">' +\n                                            '<input type=\"checkbox\" data-unique=\"' + uniqueIndex + '\" class=\"modal_video\" id=\"video_' + uniqueIndex + '\" data-url=\"' + video['link_url'] + '\" />' +\n                                            video['link_name'] +\n                                            '</p>' +\n                                            '<img src=\"' + ModalVideo.prototype.getYoutubePreview(video['link_url']) + '\" alt=\"' + video['link_name'] + '\" class=\"modal_video\" data-id=\"' + ModalVideo.prototype.getYoutubeId(video['link_url']) + '\" />' +\n                                            '<div class=\"video_play_hover\"></div>' +\n                                            '</label>' +\n                                            '</li>';\n                                    } else if (video['start_page'] === '-1') {\n                                        issetTocVideo[index] = undefined;\n                                        $(SELECTORS.OPEN_BUTTON_CONTAINER).closest('.form-group').addClass('hidden');\n                                        throw BreakException;\n                                    }\n                                });\n                            } catch (e) {\n                                if (e !== BreakException) throw e;\n                            }\n                            videosList += '</ul>';\n                            if (issetTocVideo[index] === true) {\n                                innerTocHtml +=\n                                    '<div class=\"item-toc\" style=\"margin-bottom:10px;\" data-page=\"' + currentPage + '\">' +\n                                    '<span>' + value['title'] + ', ' + ModalVideo.prototype.strings['lanebs_read_pg'] + '. ' + value['page'] + '</span><br>' +\n                                    '<a class=\"\" data-toggle=\"collapse\" href=\"#collapseDescription_' + currentPage + '_' + index + '\" role=\"button\">' +\n                                    'Видео-рекомендации' +\n                                    '</a>' +\n                                    '<div class=\"collapse\" id=\"collapseDescription_' + currentPage + '_' + index + '\">' + videosList + '</div>' +\n                                    '</div>';\n                            }\n                        });\n                    }\n                    if (issetTocVideo[0] !== undefined) {\n                        $(SELECTORS.OPEN_BUTTON_CONTAINER).closest('.form-group').removeClass('hidden');\n                        body.find(SELECTORS.DATA_TOC).html(innerTocHtml);\n                        $(body.find(SELECTORS.TRIGGER_PLAYER)).on('click', function (e) {\n                            let linkId = $(e.target).attr('data-id');\n                            ModalPlayerHandle.init(e, linkId);\n                        });\n                        $(body.find(SELECTORS.PLAY_BUTTON_HOVER)).on('click', function (e) {\n                            e.preventDefault();\n                            e.stopPropagation();\n                            $(e.currentTarget).siblings(SELECTORS.TRIGGER_PLAYER).trigger('click');\n                        });\n                    }\n                    let issetVideos = ModalVideo.prototype.getIssetVideos();\n                    if (issetVideos) {\n                        ModalVideo.prototype.printVideos(issetVideos);\n                        ModalVideo.prototype.preCheckVideos(issetVideos);\n                    }\n                });\n            });\n        }\n    };\n\n    ModalVideo.prototype.getAjaxCall = function (methodname, args, callback) {\n        return ajax.call([\n            {\n                methodname: methodname,\n                args,\n            }\n        ])[0].then(function(response) {\n            return response;\n        }).done(function(response) {\n            callback(JSON.parse(response['body']));\n            return true;\n        }).fail(function (response) {\n            console.log(response);\n            return false;\n        });\n    };\n\n    ModalVideo.prototype.printVideos = function (videos) {\n        let previewBlock = '<div class=\"col-md-3\"></div><div class=\"container col-md-9\">';\n        videos.forEach(function (value, index) {\n            previewBlock +=\n                '<div class=\"item video-item row\">' +\n                '<div class=\"img-wraps\">' +\n                '<span class=\"closes\" title=\"Delete\" data-unique=\"'+value['unique']+'\">×</span>' +\n                '<img width=\"100px;\" height=\"100px;\" src=\"'+ModalVideo.prototype.getYoutubePreview(value['link'])+'\" alt=\"'+value['name']+'\"  class=\"img-responsive\" src=\"images/image.jpg\" data-id=\"'+ModalVideo.prototype.getYoutubeId(value['link'])+'\"/>' +\n                '</div>' +\n                '<span class=\"video_preview\">'+value['name']+'</span>' +\n                '</div>';\n        });\n        previewBlock += '</div>';\n        $(SELECTORS.PREVIEW_CONTAINER).html(previewBlock);\n        ModalVideo.prototype.deleteSelectedEvent();\n    };\n\n    ModalVideo.prototype.getYoutubeId = function (link) {\n        let urlParams = link.split('?')[1];\n        return (new URLSearchParams(urlParams)).get('v');\n    };\n\n    ModalVideo.prototype.getYoutubePreview = function (link) {\n        let id = ModalVideo.prototype.getYoutubeId(link);\n        return 'https://img.youtube.com/vi/'+id+'/0.jpg';\n    };\n\n    ModalVideo.prototype.getIssetVideos = function () {\n        let videos = $(SELECTORS.VIDEOS_FIELD).val();\n        try {\n            return JSON.parse(videos);\n        } catch (e) {\n            console.log(e.message);\n            return '';\n        }\n    };\n\n    ModalVideo.prototype.preCheckVideos = function (videos) {\n        videos.forEach(function (value, index) {\n            ModalVideo.prototype.modal.getBody().find('input[data-unique=\"'+value['unique']+'\"]').trigger('click');\n        });\n    };\n\n    ModalVideo.prototype.deleteSelectedEvent = function () {\n        $(SELECTORS.DELETE_SELECTED).each(function (index, value) {\n            $(value).on('click', function (e) {\n                let videoItem = $(e.target).closest(SELECTORS.PREVIEW_CLASS);\n                let videoUnique = $(e.target).attr('data-unique');\n                ModalVideo.prototype.modal.getBody().find('input[data-unique=\"'+videoUnique+'\"]').trigger('click');\n                $(videoItem).remove();\n                ModalVideo.prototype.updateVideoField();\n            });\n        });\n    };\n\n    ModalVideo.prototype.updateVideoField = function () {\n        let videos = [];\n        let inputs = ModalVideo.prototype.modal.getBody().find('ul'+SELECTORS.SEARCH_CLASS+' input:checked');\n        inputs.each(function (index, value) {\n            let url = $(value).attr('data-url');\n            videos.push(\n                {\n                    link: url,\n                    name: $(value).closest('p').text(),\n                    unique: $(value).attr('data-unique'),\n                    video_id: ModalVideo.prototype.getYoutubeId(url)\n                });\n        });\n        $(SELECTORS.VIDEOS_FIELD).val(JSON.stringify(videos));\n        ModalVideo.prototype.printVideos(videos);\n        $(SELECTORS.CANCEL_BUTTON).trigger('click');\n    }\n\n    ModalVideo.prototype.clearAllData = function () {\n        $(SELECTORS.VIDEOS_FIELD).val('[]');\n        $(SELECTORS.PREVIEW_CONTAINER).html('');\n    };\n\n    ModalVideo.prototype.resetModal = function () {\n        ModalVideo.prototype.clearAllData();\n        ModalVideo.prototype.printTocs();\n    }\n\n\n    ModalRegistry.register(ModalVideo.TYPE, ModalVideo, 'mod_lanebs/modal_video');\n\n    return ModalVideo;\n});"],"file":"modal_video.min.js"}